"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getIOSTheme=void 0;const Jimp=require("jimp"),fse=require("fs-extra"),path=require("path"),getIOSWaterMarkRGBVal=async(e,t=375,a=812,r=64)=>{if(!fse.existsSync(e))throw new Error(`iOS 启动页 ${e} 不存在`);const i=await Jimp.read(e);i.resize(t,a);const o=Math.floor(t/2),l=a-r,s=i.getPixelColor(o,l);let{r:n,g:p,b:c}=Jimp.intToRGBA(s);const h=e=>e<=.03928?e/12.92:((e+.055)/1.055)**2.4;n=h(n/255),p=h(p/255),c=h(c/255);const u=.2126*n+.7152*p+.0722*c;return u<=.1?"Light":u>.1&&u<=.16?"LightSpecial":u>.16&&u<.25?"DarkSpecial":"Dark"},getIOSTheme=async(e,t)=>{var a;const r=await e.miniappAttr()||{};let i="Dark";return(null===(a=null==r?void 0:r.cpa_package_info)||void 0===a?void 0:a.enable_remove_watermark)?i="Default":t&&(path.isAbsolute(t)||(t=path.join(null==e?void 0:e.projectPath,t)),i=await getIOSWaterMarkRGBVal(t)),t&&(path.isAbsolute(t)||(t=path.join(null==e?void 0:e.projectPath,t)),i=await getIOSWaterMarkRGBVal(t)),i};exports.getIOSTheme=getIOSTheme;