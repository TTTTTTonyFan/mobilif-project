# MobiLiF拓练 功能流程图与详细PRD

## C端功能详细设计

---

## 4.1.1 用户管理

### 用户注册登录流程图

```mermaid
flowchart TD
    A[启动APP] --> B{是否已登录}
    B -->|是| C[进入主页]
    B -->|否| D[登录/注册页面]
    
    D --> E[选择注册方式]
    E --> F[手机号注册]
    E --> G[邮箱注册]
    E --> H[微信授权注册]
    
    F --> I[输入手机号]
    I --> J[发送验证码]
    J --> K[输入验证码]
    K --> L{验证码正确?}
    L -->|否| J
    L -->|是| M[设置密码]
    
    G --> N[输入邮箱]
    N --> O[发送验证邮件]
    O --> P[点击邮件链接验证]
    P --> Q[设置密码]
    
    H --> R[微信授权]
    R --> S{授权成功?}
    S -->|否| D
    S -->|是| T[完善基本信息]
    
    M --> T
    Q --> T
    T --> U[创建用户档案]
    U --> V[注册完成]
    V --> C
    
    D --> W[已有账号登录]
    W --> X[输入账号密码]
    X --> Y{验证成功?}
    Y -->|否| Z[显示错误信息]
    Z --> X
    Y -->|是| C
```

### 用户管理PRD

#### 功能概述
用户管理模块负责用户的注册、登录、信息管理等基础功能，支持多种注册方式，确保用户便捷安全地使用APP。

#### 核心功能

**1. 用户注册**
- **手机号注册**
  - 输入手机号 → 发送短信验证码 → 验证码校验 → 设置密码 → 完善信息
  - 验证码有效期：5分钟
  - 重发间隔：60秒
  - 密码要求：8-20位，包含字母和数字

- **邮箱注册**
  - 输入邮箱 → 发送验证邮件 → 点击邮件链接 → 设置密码 → 完善信息
  - 邮件有效期：24小时
  - 支持主流邮箱服务商

- **微信快速注册**
  - 微信授权 → 获取基本信息 → 绑定手机号(可选) → 创建账户
  - 自动获取头像、昵称
  - 支持微信登录和账号密码登录切换

**2. 用户登录**
- 账号密码登录
- 微信一键登录
- 记住登录状态(可选)
- 自动登录功能

**3. 用户信息管理**
- 基础信息：昵称、头像、性别、生日、所在城市
- 运动信息：CrossFit经验、技能水平、训练目标
- 身体数据：身高、体重、体脂率(可选)
- 隐私设置：信息可见范围、是否接受推送

**4. 账户安全**
- 修改密码
- 绑定/解绑手机号
- 绑定/解绑邮箱
- 注销账户

#### 界面设计要求
- 注册页面简洁，减少用户输入负担
- 支持手势快速切换登录方式
- 错误提示友好，提供解决建议
- 注册流程支持保存草稿，防止信息丢失

#### 技术规格
- 密码采用BCrypt加密存储
- 手机号脱敏显示
- 支持OAuth 2.0微信登录
- JWT Token管理会话

---

## 4.1.2 积分中心

### 积分获取消耗流程图

```mermaid
flowchart TD
    A[用户行为触发] --> B{积分获取场景}
    
    B --> C[完成训练]
    B --> D[参与活动]
    B --> E[邀请好友]
    B --> F[分享内容]
    
    C --> G[记录训练数据]
    G --> H[计算积分奖励]
    H --> I[积分入账]
    
    D --> J[活动参与确认]
    J --> K[活动积分规则]
    K --> I
    
    E --> L[好友注册成功]
    L --> M[邀请奖励积分]
    M --> I
    
    F --> N[内容分享成功]
    N --> O[分享奖励积分]
    O --> I
    
    I --> P[更新积分余额]
    P --> Q[推送积分通知]
    Q --> R[更新会员等级]
    
    S[积分消耗场景] --> T{消耗类型}
    T --> U[兑换权益]
    T --> V[购买虚拟商品]
    T --> W[预约课程优惠]
    
    U --> X{积分余额充足?}
    V --> X
    W --> X
    
    X -->|否| Y[余额不足提示]
    X -->|是| Z[扣除积分]
    Z --> AA[完成兑换]
    AA --> BB[更新积分余额]
```

### 积分中心PRD

#### 功能概述
积分中心是用户激励体系的核心，通过积分获取和消耗机制，提升用户活跃度和平台粘性。

#### 积分获取规则

**1. 训练完成奖励**
- 首次完成训练：+50积分
- 每日训练打卡：+20积分
- 连续训练奖励：3天+30分，7天+100分，30天+500分
- PR突破奖励：+100积分
- 完成标准WOD：+30积分

**2. 社交互动奖励**
- 分享训练成果：+10积分
- 邀请好友注册：+200积分
- 好友首次训练：+50积分
- 发表训练心得：+15积分
- 获得点赞/评论：+5积分

**3. 平台活动奖励**
- 参与官方挑战：+50-200积分
- 完成任务：+20-100积分
- 节日活动：+100-500积分

#### 积分消耗场景

**1. 权益兑换**
- 会员折扣券：200积分
- 专属头像框：500积分
- 训练装备优惠券：1000积分
- 私教课程体验：2000积分

**2. 虚拟商品**
- 技能点加速：100积分
- 特殊勋章：300积分
- 个性化主题：500积分

**3. 课程优惠**
- 预约课程9折：50积分
- 预约课程8折：100积分
- VIP预约通道：200积分

#### 会员等级体系

**等级划分标准**
- **新手 (Bronze)**: 注册用户，0-499积分
- **进阶 (Silver)**: 活跃用户，500-1999积分
- **专家 (Gold)**: 资深用户，2000-4999积分
- **大师 (Platinum)**: 核心用户，5000-9999积分
- **传奇 (Diamond)**: 顶级用户，10000+积分

**等级特权**
- Bronze: 基础功能
- Silver: 预约优先级+1，专属客服
- Gold: 月度免费课程，生日特权
- Platinum: VIP预约通道，专属活动
- Diamond: 私人定制服务，品牌合作机会

#### 界面设计要求
- 积分变化实时显示，增加仪式感
- 等级进度条可视化
- 积分获取来源透明化
- 兑换商城分类清晰

---

## 4.1.3 权益中心

### 权益获取使用流程图

```mermaid
flowchart TD
    A[权益中心入口] --> B[权益分类展示]
    
    B --> C[会员特权]
    B --> D[课程折扣]
    B --> E[专属内容]
    B --> F[优先预约]
    
    C --> G{获取方式}
    D --> G
    E --> G
    F --> G
    
    G --> H[购买获得]
    G --> I[积分兑换]
    G --> K[活动赠送]
    G --> L[等级解锁]
    
    H --> M[支付流程]
    I --> N{积分是否充足}
    K --> O[活动参与确认]
    L --> P{等级是否满足}
    
    N -->|否| Q[积分不足提示]
    N -->|是| R[积分扣除]
    P -->|否| S[等级不足提示]
    P -->|是| T[自动获得]
    
    M --> U[支付成功]
    R --> U
    O --> U
    T --> U
    
    U --> V[权益发放]
    V --> W[权益生效]
    W --> X[使用提醒]
    
    Y[权益使用] --> Z{权益类型}
    Z --> AA[折扣券使用]
    Z --> BB[预约特权使用]
    Z --> CC[内容权限解锁]
    
    AA --> DD[订单结算]
    BB --> EE[预约流程]
    CC --> FF[内容访问]
    
    DD --> GG[权益消耗]
    EE --> GG
    FF --> HH[访问记录]
    
    GG --> II[权益状态更新]
    HH --> II
```

### 权益中心PRD

#### 功能概述
权益中心管理用户的各类特权和福利，包括获取、使用、过期管理等完整生命周期。

#### 权益分类体系

**1. 会员特权**
- VIP客服优先响应
- 专属用户标识
- 生日特别福利
- 会员专享活动邀请
- 数据分析报告

**2. 课程折扣**
- 单次课程折扣券（9折、8折、7折）
- 包月课程优惠
- 私教课程体验券
- 新场馆首次免费体验

**3. 专属内容**
- 高级训练视频
- 专业营养指导
- 伤病预防知识
- 大师课程回放
- 独家访谈内容

**4. 优先预约**
- 热门课程优先预约权
- 预约时间窗口提前
- 候补列表优先级
- 临时取消课程补偿

#### 获取渠道设计

**1. 直接购买**
- 单项权益购买
- 权益包组合购买
- 订阅制权益服务
- 限时特价活动

**2. 积分兑换**
- 固定积分兑换权益
- 积分+现金混合支付
- 会员专享兑换价格

**3. 活动赠送**
- 新用户注册礼包
- 节日限定权益
- 签到奖励权益
- 任务完成奖励

**4. 等级自动解锁**
- 达到特定会员等级自动获得
- 训练天数里程碑奖励
- 消费金额达标奖励

#### 权益管理功能

**1. 权益库存管理**
- 我的权益列表
- 有效期显示
- 使用状态跟踪
- 即将过期提醒

**2. 使用记录**
- 权益使用历史
- 节省金额统计
- 使用频率分析

**3. 分享功能**
- 权益分享给好友
- 团购权益活动
- 推荐奖励机制

#### 技术实现要点
- 权益状态实时同步
- 防重复使用机制
- 权益叠加规则引擎
- 自动过期处理

---

## 4.1.4 成就中心

### 成就解锁流程图

```mermaid
flowchart TD
    A[用户行为数据] --> B[成就检测引擎]
    
    B --> C{成就类型判断}
    
    C --> D[个人里程碑]
    C --> E[个人勋章]
    C --> F[团队里程碑]
    C --> G[团队勋章]
    
    D --> H[首次完成WOD]
    D --> I[PR突破记录]
    D --> J[连续训练天数]
    D --> K[累计训练次数]
    
    E --> L[技术认证]
    E --> M[特殊挑战]
    E --> N[社区贡献]
    
    F --> O[团队训练次数]
    F --> P[集体挑战完成]
    
    G --> Q[团队协作]
    G --> R[社区建设]
    G --> S[互助精神]
    
    H --> T{达成条件判断}
    I --> T
    J --> T
    K --> T
    L --> T
    M --> T
    N --> T
    O --> T
    P --> T
    Q --> T
    R --> T
    S --> T
    
    T -->|未达成| U[继续监控]
    T -->|达成| V[成就解锁]
    
    V --> W[成就动画展示]
    W --> X[推送通知]
    X --> Y[社交分享提示]
    Y --> Z[成就档案更新]
    
    Z --> AA[积分奖励发放]
    AA --> BB[等级经验值更新]
    BB --> CC{是否触发连锁成就}
    
    CC -->|是| V
    CC -->|否| DD[完成流程]
```

### 成就中心PRD

#### 功能概述
成就中心通过里程碑和勋章系统，记录用户的训练历程，激发持续参与动力，建立社区荣誉感。

#### 个人成就体系

**1. 里程碑成就**

*训练频次类*
- 初出茅庐：完成首次CrossFit训练
- 坚持不懈：连续训练7天
- 月度战士：单月训练20次
- 年度冠军：全年训练300次
- 铁人意志：连续训练100天

*技能突破类*
- 力量觉醒：深蹲PR达到体重1.5倍
- 爆发力王：抓举PR达到体重1.2倍
- 耐力之王：完成Murph挑战
- 体操大师：完成10个标准引体向上
- 全能战士：掌握50个不同动作

*数据记录类*
- 数据狂人：记录100次训练数据
- 进步神速：单月PR提升5次
- 持续改进：连续6个月保持进步

**2. 勋章成就**

*技术认证类*
- 举重专家：通过举重技术认证
- 体操达人：掌握高难度体操动作
- 心肺强者：达到优秀有氧能力标准

*特殊挑战类*
- 挑战者：参与官方月度挑战
- 探索者：在10个不同场馆训练
- 旅行者：在5个不同城市drop-in
- 夜猫子：完成10次晚间训练

*社区贡献类*
- 分享达人：分享50次训练内容
- 导师：帮助10个新手用户
- 评论家：发表100条有价值评论
- 网红：获得1000个点赞

#### 团队成就体系

**1. 团队里程碑**
- 团队初建：创建首个训练小组
- 团队壮大：小组成员达到10人
- 团队活跃：小组月度活跃度90%
- 团队冠军：小组在竞赛中获得冠军

**2. 团队勋章**
- 协作精神：完成团队配合训练
- 互助友爱：为队友提供帮助
- 领导力：担任团队队长并表现优秀
- 凝聚力：组织线下聚会活动

#### 成就展示系统

**1. 个人成就墙**
- 成就时间轴展示
- 稀有度标识
- 获得难度评级
- 完成度统计

**2. 社交分享**
- 成就解锁动态分享
- 成就对比功能
- 成就排行榜

**3. 激励机制**
- 成就预告系统
- 进度提醒
- 即将解锁提示

#### 技术实现要点
- 实时数据监控
- 防刷机制
- 成就回溯校验
- 分布式成就计算

---

## 4.1.5 订单中心

### 订单处理流程图

```mermaid
flowchart TD
    A[用户发起订单] --> B{订单类型}
    
    B --> C[课程预约订单]
    B --> D[会员购买订单]
    B --> E[权益兑换订单]
    
    C --> F[选择课程时间]
    F --> G[确认教练信息]
    G --> H[选择支付方式]
    
    D --> I[选择会员套餐]
    I --> J[确认套餐详情]
    J --> H
    
    E --> K[选择兑换权益]
    K --> L{积分余额检查}
    L -->|不足| M[积分不足提示]
    L -->|充足| N[确认兑换]
    N --> O[积分扣除]
    
    H --> P{支付方式}
    P --> Q[微信支付]
    P --> R[支付宝]
    P --> S[银行卡]
    
    Q --> T[调用微信支付API]
    R --> U[调用支付宝API]
    S --> V[调用银联API]
    
    T --> W{支付结果}
    U --> W
    V --> W
    O --> X[兑换成功]
    
    W -->|成功| Y[支付成功]
    W -->|失败| Z[支付失败]
    W -->|取消| AA[用户取消]
    
    Y --> BB[订单状态更新]
    X --> BB
    Z --> CC[订单失败处理]
    AA --> DD[订单取消处理]
    
    BB --> EE[发送确认通知]
    EE --> FF[订单完成]
    
    CC --> GG[失败原因记录]
    DD --> HH[取消原因记录]
    
    II[订单管理] --> JJ[订单列表查看]
    JJ --> KK[订单详情查看]
    KK --> LL[订单状态跟踪]
    
    LL --> MM{订单状态}
    MM --> NN[待支付]
    MM --> OO[已支付]
    MM --> PP[已完成]
    MM --> QQ[已取消]
    MM --> RR[已退款]
    
    NN --> SS[催付提醒/取消订单]
    OO --> TT[预约提醒/申请退款]
    PP --> UU[评价/再次预约]
    QQ --> VV[查看取消原因]
    RR --> WW[查看退款详情]
```

### 订单中心PRD

#### 功能概述
订单中心管理用户的所有交易记录，包括课程预约、会员购买、权益兑换等，提供完整的订单生命周期管理。

#### 订单类型管理

**1. 课程预约订单**
- 订单信息：课程名称、时间、教练、场馆、价格
- 状态流转：待支付→已支付→待参与→已完成→待评价
- 特殊处理：临时取消、教练调整、时间变更
- 退款规则：提前24小时可退款，2小时内不可退

**2. 会员购买订单**
- 订单信息：套餐类型、有效期、价格、优惠信息
- 状态流转：待支付→已支付→已生效→已过期
- 自动续费：到期前7天提醒，支持自动续费设置
- 退款规则：7天无理由退款，使用后按比例退费

**3. 权益兑换订单**
- 订单信息：权益名称、积分价格、兑换时间
- 状态流转：兑换中→兑换成功→已使用→已过期
- 特殊处理：积分退回、权益转赠

#### 支付系统集成

**1. 支付方式支持**
- 微信支付：扫码支付、APP支付
- 支付宝：快捷支付、扫码支付
- 银行卡：借记卡、信用卡
- 余额支付：账户余额、积分抵扣

**2. 支付安全**
- SSL加密传输
- 支付密码验证
- 风险控制系统
- 异常交易监控

**3. 支付结果处理**
- 成功：订单确认、权益发放、通知推送
- 失败：原因记录、重试机制、客服介入
- 超时：自动取消、库存释放

#### 订单管理功能

**1. 订单查询**
- 全部订单列表
- 按状态筛选
- 按时间范围筛选
- 按订单类型筛选
- 关键词搜索

**2. 订单详情**
- 基本信息展示
- 支付信息详情
- 物流跟踪（如适用）
- 操作按钮（取消、退款、评价等）

**3. 订单操作**
- 取消订单：未支付订单可直接取消
- 申请退款：符合条件的订单可申请退款
- 修改订单：支持时间、教练调整（限制条件）
- 再次购买：快速复制订单

#### 退款处理流程

**1. 退款申请**
- 在线提交退款申请
- 选择退款原因
- 上传相关凭证
- 客服审核处理

**2. 退款规则**
- 课程类：提前24小时全额退款，2小时内不可退
- 会员类：7天无理由退款，使用后按比例退费
- 权益类：一般不支持退款，特殊情况人工处理

**3. 退款状态跟踪**
- 申请提交→审核中→审核通过→退款处理中→退款完成

#### 发票管理

**1. 发票申请**
- 电子发票自动生成
- 纸质发票申请流程
- 发票抬头管理
- 税号信息维护

**2. 发票查询**
- 历史发票记录
- 发票下载功能
- 发票验真查询

#### 界面设计要求
- 订单状态清晰标识
- 操作按钮位置合理
- 支付流程简洁流畅
- 异常情况友好提示

---

## 4.1.6 场馆预约

### 场馆预约完整流程图

```mermaid
flowchart TD
    A[用户进入预约页面] --> B[位置授权]
    B --> C[获取附近场馆列表]
    
    C --> D[场馆筛选功能]
    D --> E{筛选条件}
    
    E --> F[距离筛选]
    E --> G[价格筛选]
    E --> H[评分筛选]
    E --> I[设施筛选]
    E --> J[时间筛选]
    
    F --> K[更新场馆列表]
    G --> K
    H --> K
    I --> K
    J --> K
    
    K --> L[选择目标场馆]
    L --> M[查看场馆详情]
    
    M --> N[场馆介绍]
    M --> O[设施设备]
    M --> P[教练团队]
    M --> Q[用户评价]
    M --> R[课程时间表]
    
    R --> S[选择课程时间]
    S --> T{课程状态检查}
    
    T -->|已满员| U[加入候补列表]
    T -->|有余位| V[立即预约]
    T -->|即将开始| W[预约截止提示]
    
    V --> X[确认课程信息]
    X --> Y[选择支付方式]
    Y --> Z{支付类型}
    
    Z --> AA[在线支付]
    Z --> BB[会员折扣]
    Z --> CC[积分抵扣]
    Z --> DD[权益券使用]
    
    AA --> EE[支付处理]
    BB --> FF[折扣计算]
    CC --> GG[积分扣除]
    DD --> HH[权益券核销]
    
    FF --> EE
    GG --> EE
    HH --> EE
    
    EE --> II{支付结果}
    II -->|成功| JJ[预约成功]
    II -->|失败| KK[支付失败处理]
    
    JJ --> LL[发送预约确认]
    LL --> MM[课程前提醒]
    MM --> NN[到店签到]
    
    NN --> OO{签到状态}
    OO -->|成功签到| PP[开始课程]
    OO -->|未按时签到| QQ[缺席处理]
    
    PP --> RR[课程结束]
    RR --> SS[自动签退]
    SS --> TT[成绩记录]
    TT --> UU[课程评价]
    UU --> VV[完成整个流程]
    
    U --> WW[候补排队]
    WW --> XX{有位置释放}
    XX -->|是| YY[自动转为正式预约]
    XX -->|否| ZZ[继续等待]
    
    YY --> V
```

### 场馆预约PRD

#### 功能概述
场馆预约是APP的核心功能，为用户提供便捷的CrossFit场馆发现、课程预约、签到上课的完整服务流程，特别针对旅行drop-in场景优化。

#### 场馆发现功能

**1. 智能定位**
- GPS自动定位
- 手动输入地址
- 常用地址管理
- 多城市切换

**2. 场馆列表展示**
- 地图模式：直观显示场馆位置
- 列表模式：详细信息展示
- 距离排序：从近到远
- 综合排序：距离+评分+价格权重

**3. 高级筛选功能**
- 距离筛选：1km, 3km, 5km, 10km+
- 价格范围：¥50-80, ¥80-120, ¥120-200, ¥200+
- 评分筛选：4.0+, 4.5+, 5.0
- 设施筛选：停车位、淋浴间、储物柜、专业器械
- 时间筛选：营业时间、有空余课程
- 特色标签：新手友好、竞技训练、女性专场

#### 场馆详情页面

**1. 基础信息**
- 场馆名称、地址、联系方式
- 营业时间、交通指引
- 停车信息、周边设施
- 价格体系、会员政策

**2. 设施设备展示**
- 高清场馆照片轮播
- 器械设备清单
- 功能区域介绍
- 360°全景展示（高级功能）

**3. 教练团队**
- 教练个人简介
- 专业资质认证
- 教学风格标签
- 用户评价评分
- 课程时间安排

**4. 用户评价系统**
- 综合评分展示
- 分项评分：环境、教练、设备、服务
- 用户评论列表
- 照片评价展示
- 评价真实性验证

#### 课程预约系统

**1. 课程时间表**
- 周视图展示课程安排
- 实时余位显示
- 课程难度标识
- 教练信息显示
- 课程类型分类（WOD、举重、体操等）

**2. 预约流程优化**
- 一键快速预约
- 预约信息预填充
- 支付方式记忆
- 预约确认页面清晰

**3. 候补排队机制**
- 满员课程自动加入候补
- 候补位置实时显示
- 有位置释放时推送通知
- 候补转正自动确认选项

#### 支付与优惠系统

**1. 灵活支付方式**
- 单次付费：按课程付费
- 套餐购买：多次课程包
- 会员折扣：不同等级折扣
- drop-in价格：旅行用户特价

**2. 优惠券系统**
- 新用户首次免费体验
- 会员专享折扣券
- 节日限时优惠
- 推荐好友奖励

**3. 积分抵扣**
- 积分抵现功能
- 积分+现金组合支付
- 会员积分倍率加成

#### 签到上课流程

**1. 到店签到**
- 二维码扫描签到
- GPS位置验证
- 人脸识别签到（高级功能）
- 前台确认签到

**2. 课程参与**
- 课程开始推送
- 训练数据记录
- 实时成绩录入
- 教练点评记录

**3. 课程结束**
- 自动签退
- 成绩数据同步
- 卡路里消耗统计
- 技能经验值更新

#### 评价反馈系统

**1. 课程评价**
- 五星评分系统
- 多维度评价：教练、环境、课程内容、难度匹配
- 文字评价+图片上传
- 匿名评价选项

**2. 教练评价**
- 专业性评分
- 教学风格评价
- 互动性评分
- 推荐度调查

**3. 场馆综合评价**
- 设施设备评分
- 服务质量评分
- 性价比评分
- 再次光顾意愿

#### 特殊场景处理

**1. drop-in用户优化**
- 旅行模式切换
- 多城市场馆推荐
- 国际用户支持
- 语言障碍解决方案

**2. 紧急情况处理**
- 课程临时取消通知
- 教练临时更换
- 设备故障应急预案
- 恶劣天气预案

**3. 无障碍访问**
- 残障人士设施标识
- 特殊需求预约选项
- 无障碍路线指引

#### 数据分析与个性化

**1. 用户行为分析**
- 预约习惯分析
- 偏好场馆记录
- 训练时间规律
- 消费行为模式

**2. 个性化推荐**
- 基于历史的场馆推荐
- 相似用户的选择推荐
- 新场馆发现推荐
- 课程类型匹配推荐

#### 技术实现要点
- 实时库存管理系统
- 高并发预约处理
- 支付安全保障
- 数据实时同步
- 离线功能支持

---

## 4.1.7 技能树

### 技能解锁进阶流程图

```mermaid
flowchart TD
    A[用户选择技能动作] --> B[点击等级节点]
    B --> C[上传成绩视频]
    C --> D[填写成绩数据]
    D --> E[提交审核]
    
    E --> F[平台审核团队]
    F --> G{审核结果}
    
    G -->|通过| H[节点点亮]
    G -->|不通过| I[审核意见反馈]
    
    I --> J[重新上传视频]
    J --> E
    
    H --> K[已解锁动作数量+1]
    K --> L[技能树界面更新]
    L --> M{检查二级节点完成度}
    
    M --> N{该动作三个等级是否全部完成}
    N -->|是| O[点亮二级节点]
    N -->|否| P[显示进度]
    
    O --> Q[颁发动作成就勋章]
    Q --> R[推送成就通知]
    R --> S[社交分享提示]
    
    P --> T[显示剩余等级]
    T --> U[推荐下一等级训练]
    
    S --> V[技能树总览更新]
    U --> V
    
    V --> W{检查分支完成度}
    W --> X[更新用户等级]
    X --> Y[更新排行榜]
```

### 技能树PRD

#### 功能概述
技能树系统将CrossFit训练体系结构化，通过视频成绩上传和审核机制，让用户逐步解锁技能节点，获得成就感和技能认证。

#### 技能分支体系

**1. 举重分支 (Olympic Lifting & Strength)**

*抓举 (Snatch)*
- **Lv1 新人基础**: 空杠抓举技术，重量15-30kg，标准动作完成
- **Lv2 标准**: 标准抓举技术，男性40-60kg，女性25-40kg
- **Lv3 进阶**: 高重量抓举，男性70kg+，女性45kg+

*翻站 (Clean)*
- **Lv1 新人基础**: 空杠翻站技术，重量20-40kg，标准动作完成
- **Lv2 标准**: 标准翻站技术，男性50-70kg，女性35-50kg
- **Lv3 进阶**: 高重量翻站，男性80kg+，女性55kg+

*挺举 (Jerk)*
- **Lv1 新人基础**: 架上挺举技术，重量20-40kg，标准动作完成
- **Lv2 标准**: 标准挺举技术，男性50-70kg，女性35-50kg
- **Lv3 进阶**: 高重量挺举，男性80kg+，女性55kg+

*背蹲 (Back Squat)*
- **Lv1 新人基础**: 标准背蹲技术，体重0.8-1倍
- **Lv2 标准**: 力量背蹲，体重1.2-1.5倍
- **Lv3 进阶**: 大重量背蹲，体重1.8倍以上

*前蹲 (Front Squat)*
- **Lv1 新人基础**: 标准前蹲技术，体重0.6-0.8倍
- **Lv2 标准**: 力量前蹲，体重1-1.2倍
- **Lv3 进阶**: 大重量前蹲，体重1.5倍以上

*卧推 (Bench Press)*
- **Lv1 新人基础**: 标准卧推技术，体重0.6-0.8倍
- **Lv2 标准**: 力量卧推，体重1-1.2倍
- **Lv3 进阶**: 大重量卧推，体重1.5倍以上

*硬拉 (Deadlift)*
- **Lv1 新人基础**: 标准硬拉技术，体重1-1.2倍
- **Lv2 标准**: 力量硬拉，体重1.5-1.8倍
- **Lv3 进阶**: 大重量硬拉，体重2.2倍以上

**2. 体操分支 (Gymnastics)**

*引体向上 (Pull-ups)*
- **Lv1 新人基础**: 标准引体向上1-5个
- **Lv2 标准**: 连续引体向上10-15个
- **Lv3 进阶**: 连续引体向上20个以上或负重引体

*脚触杠 (Toes to Bar)*
- **Lv1 新人基础**: 悬垂举腿到90度，5-10个
- **Lv2 标准**: 标准脚触杠，10-15个连续
- **Lv3 进阶**: 快速脚触杠，20个以上连续

*单杠双力臂 (Bar Muscle-ups)*
- **Lv1 新人基础**: 辅助或跳跃单杠双力臂，1-3个
- **Lv2 标准**: 标准单杠双力臂，5-8个连续
- **Lv3 进阶**: 快速单杠双力臂，10个以上或负重

*吊环双力臂 (Ring Muscle-ups)*
- **Lv1 新人基础**: 辅助吊环双力臂，1-2个
- **Lv2 标准**: 标准吊环双力臂，3-5个连续
- **Lv3 进阶**: 快速吊环双力臂，8个以上

*倒立 (Handstand)*
- **Lv1 新人基础**: 靠墙倒立30秒以上
- **Lv2 标准**: 自由倒立30秒以上
- **Lv3 进阶**: 自由倒立60秒以上或单手倒立

*倒立撑 (Handstand Push-ups)*
- **Lv1 新人基础**: 靠墙倒立撑5-10个
- **Lv2 标准**: 标准倒立撑8-12个
- **Lv3 进阶**: 自由倒立撑或高难度变式

*倒立走 (Handstand Walk)*
- **Lv1 新人基础**: 倒立行走5-10米
- **Lv2 标准**: 倒立行走20米以上
- **Lv3 进阶**: 倒立行走50米以上或障碍倒立走

**3. 体能分支 (Conditioning)**

*墙球 (Wall Ball)*
- **Lv1 新人基础**: 6kg球，连续50个标准动作
- **Lv2 标准**: 9kg球，连续100个标准动作
- **Lv3 进阶**: 12kg球，连续150个或高强度组合

*跑步 (Running)*
- **Lv1 新人基础**: 5km完成，配速6:30/km以内
- **Lv2 标准**: 10km完成，配速6:00/km以内
- **Lv3 进阶**: 半马完成，配速5:30/km以内

*划船 (Rowing)*
- **Lv1 新人基础**: 2000m划船，9:00以内完成
- **Lv2 标准**: 2000m划船，8:00以内完成
- **Lv3 进阶**: 2000m划船，7:30以内完成

*滑雪 (Ski Erg)*
- **Lv1 新人基础**: 1000m滑雪，4:30以内完成
- **Lv2 标准**: 1000m滑雪，4:00以内完成
- **Lv3 进阶**: 1000m滑雪，3:40以内完成

*风阻自行车 (Assault Bike)*
- **Lv1 新人基础**: 1000卡路里，45分钟以内完成
- **Lv2 标准**: 1000卡路里，40分钟以内完成
- **Lv3 进阶**: 1000卡路里，35分钟以内完成

*波比 (Burpees)*
- **Lv1 新人基础**: 连续50个标准波比
- **Lv2 标准**: 连续100个标准波比
- **Lv3 进阶**: 连续150个或高强度波比变式

*跳箱 (Box Jump)*
- **Lv1 新人基础**: 50cm跳箱，连续50个
- **Lv2 标准**: 60cm跳箱，连续100个
- **Lv3 进阶**: 75cm跳箱，连续100个或高难度变式

#### 节点解锁机制

**1. 视频上传系统**

*上传要求*
- 视频时长：30秒-2分钟
- 清晰度要求：720P以上
- 角度要求：能清晰看到完整动作
- 音频要求：可选，用于计数或教练指导

*成绩数据录入*
- 重量类：精确到0.5kg
- 次数类：精确到个数
- 时间类：精确到秒
- 距离类：精确到米

**2. 审核机制**

*审核团队*
- 认证教练审核员
- 技术动作专家
- 视频质量检查员

*审核标准*
- 动作标准性：符合CrossFit官方标准
- 成绩真实性：重量、次数、时间准确
- 视频完整性：无剪辑、无作弊
- 安全性评估：动作执行安全规范

*审核时效*
- 标准审核：48小时内完成
- 争议案例：72小时内专家会审
- 申诉处理：7个工作日内终审

**3. 节点状态管理**

*节点状态*
- **未解锁**：灰色显示，显示解锁条件
- **审核中**：黄色显示，显示审核进度
- **已点亮**：绿色显示，显示完成时间
- **争议中**：橙色显示，等待复审

*进度显示*
- 单个动作完成度：Lv1/Lv2/Lv3进度条
- 二级节点完成度：7个动作完成情况
- 一级分支完成度：整体分支进度
- 总体技能树完成度：全部技能统计

#### 成就奖励系统

**1. 单项成就**

*节点点亮奖励*
- 积分奖励：Lv1(+50分)，Lv2(+100分)，Lv3(+200分)
- 经验值：技能经验+10/20/50
- 称号碎片：收集碎片合成称号

*二级节点完成奖励*
- 动作徽章：专属动作掌握徽章
- 大额积分：+500积分
- 特殊称号：如"抓举大师"、"引体之王"
- 社交展示：朋友圈炫耀模板

**2. 分支成就**

*举重分支全解锁*
- 称号：举重专家
- 徽章：力量之源徽章
- 权益：举重类课程9折优惠
- 认证：平台官方力量认证

*体操分支全解锁*
- 称号：体操大师
- 徽章：技巧之神徽章
- 权益：体操类课程9折优惠
- 认证：平台官方技巧认证

*体能分支全解锁*
- 称号：体能专家
- 徽章：耐力之心徽章
- 权益：体能类课程9折优惠
- 认证：平台官方体能认证

**3. 全能成就**

*三分支全解锁*
- 称号：CrossFit全能战士
- 徽章：传奇徽章
- 权益：全平台课程8折优惠
- 特权：成为平台技术顾问
- 奖励：定制运动装备

#### 社交分享功能

**1. 成就分享**
- 节点点亮动态
- 视频成绩展示
- 进步对比图表
- 挑战好友功能

**2. 排行榜系统**
- 单项技能排行
- 综合实力排行
- 好友技能对比
- 城市/场馆排行

#### 技术实现要点

**1. 视频处理**
- 视频压缩优化
- 云存储管理
- 播放性能优化
- 审核工具集成

**2. 数据管理**
- 成绩数据库设计
- 审核状态同步
- 进度实时更新
- 数据备份机制

**3. 防作弊机制**
- 视频水印技术
- 设备信息验证
- 异常数据检测
- 人工智能辅助审核

---

## B端功能详细设计

---

## 4.2.1 场馆管理

### B端轻量场馆管理流程图

```mermaid
flowchart TD
    A[场馆注册登录] --> B[场馆管理后台]
    
    B --> C[基本信息管理]
    B --> D[教练信息管理]
    B --> E[课程表管理]
    B --> F[预约通知查看]
    
    C --> G[编辑场馆名称]
    C --> H[编辑详细地址]
    C --> I[编辑联系电话]
    C --> J[设置营业时间]
    
    G --> K[保存更新]
    H --> K
    I --> K
    J --> K
    
    D --> L[添加教练]
    D --> M[编辑教练信息]
    D --> N[删除教练]
    
    L --> O[输入教练姓名]
    O --> P[上传教练头像]
    P --> Q[编写教练简介]
    Q --> R[保存教练信息]
    
    M --> S[修改现有教练]
    S --> T[更新信息]
    
    E --> U[创建课程]
    E --> V[编辑课程]
    E --> W[删除课程]
    
    U --> X[设置课程名称]
    X --> Y[选择授课教练]
    Y --> Z[设置上课时间]
    Z --> AA[设置课程人数]
    AA --> BB[设置课程价格]
    BB --> CC[发布课程]
    
    V --> DD[修改现有课程]
    DD --> EE[更新课程信息]
    
    FF[用户预约课程] --> GG[系统自动推送通知]
    GG --> H[场馆运营查看通知]
    H --> II[确认预约信息]
    II --> JJ[准备课程]
    
    K --> KK[用户端信息同步]
    R --> KK
    T --> KK
    CC --> KK
    EE --> KK
```

### 场馆管理PRD (轻量版)

#### 功能概述
轻量级场馆管理系统，为CrossFit场馆提供基础的信息维护和预约管理功能，简化操作流程，降低使用门槛。

#### 场馆基本信息管理

**1. 基础信息维护**

*场馆基本信息*
- **场馆名称**: 支持中英文，最多50字符
- **详细地址**: 省市区详细地址，支持地图选点
- **联系电话**: 支持座机和手机号码
- **营业时间**: 工作日和周末时间可分别设置

*操作方式*
- 在线表单编辑
- 实时保存功能
- 修改历史记录
- 一键恢复功能

*数据同步*
- 修改后立即同步到用户端
- 搜索索引自动更新
- 地图位置自动校正

#### 教练信息管理

**1. 教练档案管理**

*基础信息*
- **教练姓名**: 中英文姓名，最多20字符
- **教练头像**: 支持jpg/png格式，最大2MB
- **教练简介**: 个人介绍，最多200字符

*操作功能*
- 添加新教练
- 编辑现有教练
- 删除教练（需确认）
- 批量管理功能

*头像上传*
- 支持本地上传
- 自动压缩处理
- 头像审核机制
- 默认头像选择

**2. 教练状态管理**

*状态设置*
- 在职/离职状态
- 可预约/不可预约状态
- 临时休假状态

*显示控制*
- 用户端显示控制
- 课程分配权限
- 预约接收设置

#### 课程表管理

**1. 课程创建**

*基础信息设置*
- **课程名称**: CrossFit WOD、举重课等，最多30字符
- **授课教练**: 从已添加教练中选择
- **上课时间**: 日期+时间段选择
- **课程人数**: 最大容纳人数设置
- **课程价格**: 单次课程价格

*课程类型*
- WOD课程
- 举重专项
- 体操技巧
- 新手入门
- 私教课程

**2. 课程时间管理**

*时间设置*
- 日期选择器
- 时间段设置（如：9:00-10:00）
- 重复课程设置（每周固定时间）
- 节假日特殊安排

*冲突检测*
- 教练时间冲突提醒
- 场地容量超限提醒
- 重复课程警告

**3. 课程状态管理**

*课程状态*
- 正常开放预约
- 暂停预约
- 已取消
- 已结束

*快速操作*
- 一键取消课程
- 批量修改价格
- 课程复制功能

#### 预约通知系统

**1. 实时通知推送**

*通知类型*
- 新预约通知
- 取消预约通知
- 预约变更通知

*通知内容*
- 用户姓名和联系方式
- 预约课程和时间
- 预约状态变化
- 特殊需求备注

*推送方式*
- 短信通知
- 微信推送
- APP内通知
- 邮件通知（可选）

**2. 通知管理**

*通知列表*
- 按时间倒序排列
- 已读/未读状态
- 通知分类筛选
- 搜索功能

*批量操作*
- 批量标记已读
- 批量删除通知
- 通知导出功能

#### 简化的数据统计

**1. 基础数据展示**

*今日数据*
- 今日预约人数
- 今日收入统计
- 热门课程排行
- 教练工作量

*本周/本月概览*
- 预约趋势图表
- 收入变化曲线
- 用户增长情况

**2. 简单报表**

*预约报表*
- 按日期统计预约量
- 按课程类型统计
- 按教练统计工作量

*导出功能*
- Excel格式导出
- 自定义时间范围
- 基础图表生成

#### 移动端轻量应用

**1. 场馆管理APP**

*核心功能*
- 查看今日课程安排
- 接收预约通知
- 快速确认/取消课程
- 紧急联系用户

*操作特点*
- 界面简洁直观
- 一键操作为主
- 离线数据缓存
- 快速响应设计

**2. 微信小程序版本**

*基础管理*
- 课程信息查看
- 预约通知接收
- 简单数据统计
- 客服消息处理

#### 用户支持与帮助

**1. 操作指南**
- 图文操作教程
- 视频使用指南
- 常见问题解答
- 功能介绍页面

**2. 客服支持**
- 在线客服聊天
- 电话技术支持
- 使用问题反馈
- 功能建议收集

#### 系统安全与稳定性

**1. 数据安全**
- 数据定期备份
- 操作日志记录
- 权限访问控制
- 敏感信息加密

**2. 系统稳定性**
- 7×24小时监控
- 自动故障恢复
- 数据同步保障
- 性能优化

---

## 4.2.2 订单管理

### B端预约通知管理流程图

```mermaid
flowchart TD
    A[用户完成预约] --> B[系统生成预约订单]
    B --> C[推送通知到场馆]
    
    C --> D[场馆接收通知]
    D --> E[通知详情展示]
    
    E --> F[预约信息]
    E --> G[用户信息]
    E --> H[课程信息]
    
    F --> I[课程名称]
    F --> J[预约时间]
    F --> K[预约人数]
    
    G --> L[用户姓名]
    G --> M[联系电话]
    G --> N[特殊需求备注]
    
    H --> O[授课教练]
    H --> P[课程价格]
    H --> Q[支付状态]
    
    I --> R[场馆运营确认]
    J --> R
    K --> R
    L --> R
    M --> R
    N --> R
    O --> R
    P --> R
    Q --> R
    
    R --> S[标记为已处理]
    S --> T[准备课程安排]
    
    U[用户取消预约] --> V[推送取消通知]
    V --> W[场馆接收取消通知]
    W --> X[更新课程余位]
    X --> Y[标记通知已处理]
    
    Z[课程时间变更] --> AA[推送变更通知]
    AA --> BB[用户确认变更]
    BB --> CC[更新预约信息]
```

### 预约通知管理PRD (轻量版)

#### 功能概述
轻量级预约通知管理系统，为场馆运营人员提供实时的预约通知接收和处理功能，简化预约管理流程。

#### 通知接收系统

**1. 实时通知推送**

*通知触发场景*
- 用户新预约课程
- 用户取消预约
- 用户修改预约时间
- 支付状态变更

*通知推送方式*
- APP内消息推送
- 短信通知（可选）
- 微信公众号推送
- 邮件通知（可选）

*通知内容结构*
```
【新预约通知】
用户：张三 (138****1234)
课程：CrossFit WOD
时间：2024-01-15 19:00-20:00
教练：李教练
价格：¥80
备注：第一次参加，请多指导
```

**2. 通知分类管理**

*通知类型*
- 新预约通知（绿色标识）
- 取消预约通知（红色标识）
- 修改预约通知（橙色标识）
- 支付异常通知（黄色标识）

*优先级设置*
- 紧急通知：支付异常、课程冲突
- 普通通知：正常预约、取消预约
- 提醒通知：课程即将开始、设备维护

#### 通知详情展示

**1. 预约信息详情**

*基础信息*
- 预约编号：系统自动生成
- 预约时间：具体日期和时间段
- 课程名称：完整课程名称
- 授课教练：教练姓名
- 课程价格：实际支付金额

*用户信息*
- 用户姓名：真实姓名或昵称
- 联系电话：便于紧急联系
- 用户等级：新手/熟练/专家
- 特殊需求：用户备注的特殊要求

*支付信息*
- 支付状态：已支付/待支付/已退款
- 支付方式：微信/支付宝/银行卡
- 优惠信息：使用的优惠券或折扣
- 支付时间：具体支付完成时间

**2. 快速操作功能**

*常用操作*
- 标记已处理：确认已知晓预约
- 联系用户：快速拨打电话
- 查看历史：该用户的预约历史
- 课程准备：设置课程准备提醒

*异常处理*
- 课程调整：修改课程时间或教练
- 预约确认：电话确认特殊预约
- 退款处理：协助处理退款申请

#### 通知列表管理

**1. 通知列表展示**

*列表排序*
- 按时间倒序：最新通知在顶部
- 未处理优先：未处理通知优先显示
- 紧急通知置顶：重要通知始终在顶部

*筛选功能*
- 按日期筛选：今日/本周/本月
- 按状态筛选：未处理/已处理/全部
- 按类型筛选：预约/取消/修改/异常
- 按教练筛选：特定教练的课程通知

**2. 批量操作**

*批量处理*
- 批量标记已读：一键处理多个通知
- 批量导出：导出通知数据到Excel
- 批量删除：删除过期通知记录

*搜索功能*
- 用户姓名搜索
- 手机号码搜索
- 课程名称搜索
- 时间范围搜索

#### 统计数据展示

**1. 简单数据统计**

*今日数据*
- 今日新预约数量
- 今日取消预约数量
- 今日预约收入统计
- 待处理通知数量

*趋势分析*
- 近7天预约趋势
- 热门课程排行
- 热门时段分析
- 教练工作量统计

**2. 数据导出**

*导出内容*
- 预约明细列表
- 收入统计报表
- 用户信息汇总
- 课程统计分析

*导出格式*
- Excel表格格式
- PDF报告格式
- 图表可视化格式

#### 移动端通知管理

**1. 手机APP功能**

*核心功能*
- 实时接收推送通知
- 快速查看预约详情
- 一键标记已处理
- 紧急联系用户

*界面特点*
- 简洁直观的通知列表
- 快速操作按钮
- 清晰的状态标识
- 便捷的搜索功能

**2. 微信小程序版本**

*基础功能*
- 接收微信消息推送
- 查看预约通知详情
- 简单的统计数据查看
- 客服消息处理

#### 通知设置管理

**1. 推送设置**

*推送开关*
- 新预约通知开关
- 取消预约通知开关
- 支付异常通知开关
- 系统维护通知开关

*推送时间*
- 工作时间推送设置
- 非工作时间处理方式
- 紧急通知例外设置

*推送方式选择*
- 仅APP内通知
- APP+短信通知
- APP+微信通知
- 全渠道通知

**2. 自动化处理**

*自动确认*
- 常规预约自动确认
- 老用户预约自动处理
- 小额预约自动通过

*自动提醒*
- 课程开始前1小时提醒
- 课程结束后评价提醒
- 异常情况自动报警

#### 客服集成功能

**1. 快速客服**

*用户沟通*
- 一键拨打用户电话
- 发送短信通知用户
- 通过APP内消息联系

*常用话术*
- 预约确认话术模板
- 课程变更通知模板
- 退款处理话术模板

**2. 问题处理**

*常见问题*
- 预约时间冲突处理
- 支付异常问题解决
- 用户投诉快速响应

*处理流程*
- 问题分类识别
- 标准处理流程
- 上级升级机制