# 场馆列表功能测试文档总览

## 📋 测试文档结构

本目录包含了MobiLiF场馆列表功能的完整测试资源，帮助开发人员和测试人员快速开展测试工作。

## 📁 文件结构

```
tests/
├── README.md                                    # 本文件 - 测试文档总览
├── test-data.json                              # 完整测试数据集
├── MobiLiF-Gym-List-API.postman_collection.json    # Postman API测试集合
├── postman-environment.json                   # Postman环境配置
└── automated-test-runner.js                   # 自动化测试脚本（可选）

docs/
├── gym-list-test-cases.md                     # 详细测试用例文档
├── miniprogram-testing-guide.md               # 小程序测试指导
├── e2e-testing-guide.md                       # 端到端测试指南
└── gym-list-feature.md                        # 功能开发文档
```

## 🚀 快速开始

### 1. API接口测试（推荐先执行）

**使用Postman进行API测试**：
1. 导入测试集合：`tests/MobiLiF-Gym-List-API.postman_collection.json`
2. 导入环境配置：`tests/postman-environment.json`
3. 启动后端服务：`npm run start:dev`
4. 运行完整测试集合

**使用命令行进行API测试**：
```bash
# 运行自动化API测试脚本
./scripts/test-api.sh

# 或运行简化的mock测试
./scripts/test-api-mock.sh
```

### 2. 小程序功能测试

**使用微信开发者工具**：
1. 参考：`docs/miniprogram-testing-guide.md`
2. 打开微信开发者工具
3. 导入小程序项目
4. 按照测试指导逐项测试

### 3. 端到端测试

**完整环境测试**：
```bash
# 一键启动完整测试环境
./scripts/run-e2e-test.sh

# 查看详细测试指南
cat docs/e2e-testing-guide.md
```

## 📊 测试覆盖范围

### API接口测试覆盖
- ✅ **基础功能**：列表获取、分页、参数验证
- ✅ **搜索功能**：关键词搜索、模糊匹配、空结果处理
- ✅ **筛选功能**：城市、类型、课程筛选
- ✅ **地理位置**：距离计算、范围查询、坐标验证
- ✅ **排序功能**：距离、评分、名称排序
- ✅ **组合查询**：多条件组合、复杂查询
- ✅ **安全性测试**：认证、授权、参数注入
- ✅ **性能测试**：响应时间、并发处理
- ✅ **异常处理**：错误码、边界条件

### 小程序测试覆盖
- ✅ **页面功能**：初始化、加载、刷新
- ✅ **用户交互**：搜索、筛选、城市切换
- ✅ **权限处理**：位置权限、授权流程
- ✅ **列表操作**：下拉刷新、上拉加载
- ✅ **异常处理**：网络异常、数据异常
- ✅ **性能表现**：加载速度、内存使用
- ✅ **兼容性**：多设备、多场景
- ✅ **稳定性**：长时间使用、压力测试

## 🎯 测试执行建议

### 第一阶段：API功能验证（30分钟）
1. 启动后端服务
2. 运行Postman测试集合
3. 验证所有API接口正常
4. 检查性能指标

### 第二阶段：前端功能测试（45分钟）
1. 打开微信开发者工具
2. 按照测试指导逐项测试
3. 重点测试用户交互流程
4. 验证异常情况处理

### 第三阶段：端到端集成测试（15分钟）
1. 运行完整端到端测试
2. 验证前后端协作
3. 确认数据一致性
4. 测试完整用户场景

## 📈 测试数据说明

### 测试数据来源
- **种子数据**：`prisma/seeds/gym_seed_data.sql`
- **测试用例数据**：`tests/test-data.json`
- **Mock数据**：自动生成的模拟数据

### 数据覆盖情况
- **城市分布**：北京(3)、上海(2)、广州(2)、深圳(2)、杭州(1)
- **场馆类型**：CrossFit认证(4)、综合训练馆(4)、专项训练馆(2)
- **课程类型**：CrossFit、Olympic Lifting、Hyrox等全覆盖
- **特殊情况**：24小时营业、临时歇业、新开场馆

### 测试环境配置
```json
{
  "本地开发": "http://localhost:3000",
  "测试服务器": "http://8.147.235.48:3000",
  "数据库": "MySQL 8.0+",
  "认证Token": "test-token"
}
```

## 🔧 测试工具使用

### Postman集合特点
- **完整覆盖**：包含所有API接口测试
- **自动验证**：响应数据结构和业务逻辑验证
- **性能监控**：响应时间和性能指标记录
- **环境切换**：支持本地和生产环境切换
- **批量执行**：支持一键运行所有测试用例

### 测试数据特点
- **结构化**：JSON格式，易于解析和使用
- **完整性**：覆盖所有测试场景和边界条件
- **真实性**：基于实际业务场景设计
- **可扩展**：易于添加新的测试用例

### 自动化脚本特点
- **一键执行**：简化测试流程
- **详细日志**：完整的测试过程记录
- **结果统计**：自动生成测试报告
- **错误定位**：精确的错误信息和建议

## 🐛 常见问题解决

### API测试常见问题

**问题1：连接拒绝**
```
Error: connect ECONNREFUSED 127.0.0.1:3000
```
**解决方案**：
- 确认后端服务已启动：`npm run start:dev`
- 检查端口占用：`lsof -i :3000`
- 验证服务健康：`curl http://localhost:3000/health`

**问题2：认证失败**
```json
{"code": 401, "message": "Unauthorized"}
```
**解决方案**：
- 检查Token配置：确认使用了正确的测试Token
- 更新环境变量：在Postman中设置正确的`token`值
- 验证认证逻辑：检查后端认证中间件配置

**问题3：数据不匹配**
```
Test failed: Expected 10, but got 0
```
**解决方案**：
- 检查数据库数据：确认种子数据已正确插入
- 重新执行种子脚本：`mysql -u root -p mobilif_test < prisma/seeds/gym_seed_data.sql`
- 验证数据库连接：检查数据库配置和连接状态

### 小程序测试常见问题

**问题1：页面白屏**
**解决方案**：
- 检查控制台错误信息
- 验证API接口是否正常
- 确认小程序AppID配置正确

**问题2：位置权限异常**
**解决方案**：
- 在开发者工具中重新设置位置权限
- 使用地理位置模拟功能测试
- 检查位置权限处理代码逻辑

**问题3：数据加载失败**
**解决方案**：
- 确认网络配置正确（不校验合法域名）
- 检查API请求地址和参数
- 验证后端服务运行状态

## 📞 支持联系

### 技术文档
- **API文档**：查看 `docs/gym-list-feature.md`
- **开发指南**：查看 `docs/development-workflow.md`
- **部署文档**：查看 `docs/deployment-guide.md`

### 测试支持
- **测试用例**：`docs/gym-list-test-cases.md`
- **测试数据**：`tests/test-data.json`
- **自动化脚本**：`scripts/` 目录下的各种测试脚本

### 问题反馈
如遇到测试相关问题，请提供：
1. 详细的错误信息和截图
2. 操作步骤复现路径
3. 环境信息（操作系统、浏览器、工具版本）
4. 测试数据和配置信息

**让我们一起确保MobiLiF场馆列表功能的高质量交付！** 🎉

---

*最后更新：2024-01-XX*  
*版本：v1.0.0*